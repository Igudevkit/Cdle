<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Produtodle</title>

  <style>
    /* =========================================================
       ESTILOS GERAIS
       ---------------------------------------------------------
       – Layout centralizado em tela cheia.
       – Paleta escura “dark forest” (#1a3a2a) com destaques verdes.
       ========================================================= */
    body{
      font-family: Arial, sans-serif;
      background:#1a3a2a;
      color:#e0e0e0;
      margin:0; padding:0;
      display:flex; flex-direction:column;
      justify-content:center; align-items:center;
      height:100vh;
      transition:all .3s ease;
    }

    h1{
      margin:0 0 2rem;
      font-size:2.5rem;
      color:#a0e0a0;
      text-align:center;
      text-shadow:2px 2px 4px rgba(0,0,0,.6);
    }

    /* ---------- Área de controles ---------- */
    #controls{ display:flex; flex-wrap:wrap; gap:1rem; margin-bottom:2rem; }
    button{
      background:#38a169;      /* verde‑esmeralda */
      color:#fff;
      border:none; border-radius:8px;
      padding:.75rem 1.5rem;
      font-size:1.1rem;
      cursor:pointer;
      transition:transform .2s;
    }
    button:focus{ outline:none; transform:scale(1.05); }

    /* ---------- Caixa de pesquisa com sugestões ---------- */
    .search-box{
      width:300px;
      position:relative;
      background:#2d5339;
      border:1px solid #4a6d4e;
      border-radius:8px;
      padding:.5rem;
      box-shadow:0 2px 4px rgba(0,0,0,.4);
    }
    .search-box input{
      width:95%;
      border:none; border-radius:4px;
      padding:.5rem;
      background:#1e2d1a;
      color:#e0e0e0;
      font-size:1rem;
    }
    .search-box input::placeholder{ color:#a0b29f; }
    .search-box input:focus{ outline:none; box-shadow:0 0 4px #38a169; }

    /* Lista suspensa de sugestões */
    .suggestions{
      position:absolute; top:100%; left:0; right:0;
      background:#1e2d1a;
      border:1px solid #4a6d4e;
      border-radius:4px;
      max-height:120px;
      overflow-y:auto;
      z-index:100;
      display:none;            /* inicia oculta */
    }
    .suggestion-item{
      padding:.5rem;
      cursor:pointer;
      color:#e0e0e0;
    }
    .suggestion-item:hover{ background:#38a169; color:#fff; }

    /* ---------- Tabela de palpites ---------- */
    table{
      width:90%; max-width:900px;
      border-collapse:collapse;
      margin-top:2rem;
      background:#1e2d1a;
      border-radius:8px;
      overflow:hidden;          /* aplica cantos arredondados */
    }
    th,td{ padding:1rem; text-align:center; border-bottom:1px solid #4a6d4e; }
    th{ background:#2a4836; color:#a0e0a0; }
    td{ background:#1e2d1a; color:#e0e0e0; transition:background-color .3s; }

    /* Cores de feedback */
    td.exact   { background:#16a34a; color:#fff; }   /* valor exato */
    td.partial { background:#eab308; color:#fff; }   /* parcialmente correto */
    td.none    { background:#ef4444; color:#fff; }   /* incorreto */
    .up::after   { content:"⬆️"; animation:bounceUp   .5s infinite; }
    .down::after { content:"⬇️"; animation:bounceDown .5s infinite; }

    /* Animações */
    @keyframes bounceUp   { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-5px);} }
    @keyframes bounceDown { 0%,100%{transform:translateY(0);} 50%{transform:translateY( 5px);} }
    @keyframes fadeIn     { from{opacity:0;} to{opacity:1;} }
    tbody tr{ opacity:0; animation:fadeIn .5s forwards; }

    /* Sombra reutilizável */
    .shadow{ box-shadow:0 4px 6px rgba(0,0,0,.3); }
  </style>
</head>

<body>
  <!-- ---------- Título ---------- -->
  <h1>Produtodle Clássico</h1>

  <!-- ---------- Controles principais ---------- -->
  <div id="controls" class="shadow">
    <!-- Caixa de busca + sugestões -->
    <div class="search-box">
      <input id="searchBox" type="text" placeholder="Digite o produto..." autocomplete="off">
      <div id="suggestions" class="suggestions"></div>
    </div>

    <!-- Botões -->
    <button id="guessBtn">Palpitar</button>
    <button id="newGameBtn">Novo Jogo</button>
    <button id="manualBtn" onclick="window.open('manual.html','_blank')">Manual</button>
  </div>

  <!-- ---------- Quadro de palpites ---------- -->
  <table id="board">
    <thead>
      <tr>
        <th>Produto</th><th>Tipo</th><th>Capac. Usuários</th>
        <th>Autenticação</th><th>Comunicação</th><th>Grau IP</th><th>Frequência (MHz)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- =========================================================
       LÓGICA DO JOGO (JavaScript)
       ========================================================= -->
  <script>
    /* ---------- Base de dados dos produtos ---------- */
    const PRODUCTS = [
      { nome:"SS 1530 MF W",      tipo:["Controlador"],               capacidade: 3000,
        auth:["Senha","Tag","Face","QRcode"],         com:["Ethernet","wi-fi"], grauIP:"N/A",  freq:13.56 },
      { nome:"InControl",        tipo:["Software"],                  capacidade:25000,
        auth:["Senha"],                                com:"LAN",                grauIP:"N/A",  freq:0 },
      { nome:"Defense Lite",     tipo:["Software"],                  capacidade: 5000,
        auth:["Senha"],                                com:"Qualquer",           grauIP:"N/A",  freq:0 },
      { nome:"SS 3420 MF Bio",   tipo:["Controlador"],               capacidade:30000,
        auth:["Tag","Biometria"],                    com:"Ethernet",            grauIP:"IP65", freq:13.56 },
      { nome:"SS 3540 MF Face EX",tipo:["Controlador"],              capacidade: 6000,
        auth:["Senha","Tag","Face","QRcode"],         com:"Ethernet",            grauIP:"IP65", freq:13.56 },
      { nome:"SS 5542 MF W",     tipo:["Controlador"],               capacidade:20000,
        auth:["Senha","Tag","Face","QRcode","Biometria"],
                                                       com:["Ethernet","wi-fi"],grauIP:"IP55", freq:13.56 },
      { nome:"SS 311E",          tipo:["Controlador"],               capacidade:10000,
        auth:["Senha","Biometria"],                   com:"Ethernet",            grauIP:"IP66", freq:125 },
      { nome:"Hybrid X",         tipo:["Controlador","Software"],    capacidade:15000,
        auth:["2FA","Senha"],                          com:"Ethernet",           grauIP:"IP55", freq:13.56 }
    ];

    /* ---------- Parâmetros globais ---------- */
    const MAX_TRIES = 8;          // tentativas por jogo
    const MAX_SUG   = 3;          // sugestões exibidas na busca
    let   target;                 // produto sorteado
    let   tries;                  // tentativas usadas

    /* ---------- Referências rápidas ao DOM ---------- */
    const sb    = document.getElementById("searchBox");
    const sugC  = document.getElementById("suggestions");
    const tbod  = document.querySelector("#board tbody");

    /* =================================================
       FUNÇÃO: reset()
       -------------------------------------------------
       Inicia / reinicia a partida:
       – limpa a tabela,
       – zera tentativas,
       – sorteia novo produto‑alvo,
       – limpa e foca a caixa de busca.
       ================================================= */
    function reset(){
      tbod.innerHTML = "";
      tries = 0;
      target = PRODUCTS[Math.floor(Math.random()*PRODUCTS.length)];
      sb.value = "";
      hideSug();
      sb.focus();
    }

    /* ---------- SUGESTÕES DE AUTOCOMPLETE ---------- */
    function getSug(q){
      if(!q.trim()) return [];
      return PRODUCTS
             .filter(p => p.nome.toLowerCase().includes(q.toLowerCase()))
             .slice(0, MAX_SUG);
    }

    function showSug(q){
      const opts = getSug(q);
      if(opts.length){
        sugC.style.display = "block";
        sugC.innerHTML = opts
          .map(o => `<div class="suggestion-item">${o.nome}</div>`)
          .join("");
        // Clique em item de sugestão → preenche input e executa jogada
        document.querySelectorAll(".suggestion-item")
                .forEach((el,i) => el.onclick = () =>{
                  sb.value = opts[i].nome;
                  hideSug();
                  play();        // palpita automaticamente
                });
      }else hideSug();
    }

    function hideSug(){
      sugC.style.display = "none";
      sugC.innerHTML = "";
    }

    /* ---------- Eventos da caixa de busca ---------- */
    sb.addEventListener("input",  e => showSug(e.target.value));
    sb.addEventListener("keydown",e =>{
      if(e.key === "Enter"){
        e.preventDefault();
        if(!sb.value.trim()) return;
        const opts  = getSug(sb.value);
        const guess = PRODUCTS.find(p=>p.nome===sb.value) || opts[0];
        if(guess) evaluateAndRender(guess);
        hideSug();
      }
    });

    /* =================================================
       FUNÇÃO: evaluateAndRender(guess)
       -------------------------------------------------
       – Interrompe se esgotou tentativas.
       – Avalia palpite, pinta tabela e contabiliza.
       – Exibe alertas de vitória ou derrota.
       ================================================= */
    function evaluateAndRender(guess){
      if(tries >= MAX_TRIES) return;
      const res = evaluate(guess);   // obtém objeto com “exact|partial|...”
      render(guess,res);             // desenha linha na tabela
      tries++;
      if(win(res))
        alert(`Parabéns! Você acertou em ${tries} tentativa(s).`);
      else if(tries === MAX_TRIES)
        alert(`Fim de jogo! O produto era ${target.nome}.`);
    }

    /* ---------- Funções auxiliares de avaliação ---------- */
    const toArr   = v => Array.isArray(v)?v:[v];
    const evalList= (g,t)=> g.length===t.length && g.every(v=>t.includes(v))
                              ?"exact": g.some(v=>t.includes(v))?"partial":"none";
    const evalIP  = (g,t)=> g===t ?"exact": g.slice(0,2)===t.slice(0,2)?"partial":"none";
    const evalNum = (g,t)=> g===t ?"exact": g>t ?"down":"up";
    const evalFreq= (g,t)=> g===t ?"exact": Math.abs(g-t)<=10 ?"partial": g>t ?"down":"up";

    /* ---------- Avaliação completa do palpite ---------- */
    function evaluate(g){
      return{
        tipo     : evalList(toArr(g.tipo),  toArr(target.tipo)),
        capacidade: evalNum (g.capacidade,  target.capacidade),
        auth     : evalList(toArr(g.auth),  toArr(target.auth)),
        com      : g.com===target.com ?"exact":"none",
        grauIP   : evalIP  (g.grauIP,       target.grauIP),
        freq     : evalFreq(g.freq,         target.freq)
      };
    }

    /* ---------- Insere linha na tabela ---------- */
    function render(g,r){
      const tr = document.createElement("tr");
      tr.innerHTML =
        `<td>${g.nome}</td>
         <td class="${r.tipo}">${toArr(g.tipo).join(", ")}</td>
         <td class="${r.capacidade}">${g.capacidade}</td>
         <td class="${r.auth}">${toArr(g.auth).join(", ")}</td>
         <td class="${r.com}">${g.com}</td>
         <td class="${r.grauIP}">${g.grauIP}</td>
         <td class="${r.freq}">${g.freq||"-"}</td>`;
      tbod.appendChild(tr);
    }

    /* ---------- Verifica vitória ---------- */
    const win = r => Object.values(r).every(v => v==="exact");

    /* ---------- Botões ---------- */
    document.getElementById("guessBtn").addEventListener("click", ()=>{
      if(!sb.value.trim()) return;
      const opts  = getSug(sb.value);
      const guess = PRODUCTS.find(p=>p.nome===sb.value) || opts[0];
      if(guess) evaluateAndRender(guess);
      hideSug();
    });
    document.getElementById("newGameBtn").addEventListener("click", reset);

    /* ---------- Começa o jogo ---------- */
    reset();

    /* ---------- Atalho play() usado no clique da sugestão ---------- */
    function play(){ document.getElementById("guessBtn").click(); }
  </script>
</body>
</html>
